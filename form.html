<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Beauty Expert</title>
<style>
  :root {
    --accent: #F48FB1;
    --accent-dark: #C2185B;
    --bg: #FFF8F9;
    --input: #FDEFF3;
    --text: #333;
  }
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: var(--bg);
    display: flex; justify-content: center; align-items: center;
    height: 100vh; margin: 0;
  }
  .form-box {
    background: #fff;
    border-radius: 12px;
    padding: 30px 40px;
    box-shadow: 0 4px 12px rgba(0,0,0,.1);
    width: 100%; max-width: 420px;
  }
  h2 {
    text-align: center;
    color: var(--accent);
    margin-bottom: 20px;
  }
  .lang-switch {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-bottom: 15px;
  }
  .lang-switch button {
    width: 36px;
    height: 36px;
    border: 1px solid var(--accent);
    border-radius: 6px;
    background: white;
    cursor: pointer;
    font-weight: bold;
    color: var(--accent);
  }
  .lang-switch button.active {
    background: var(--accent);
    color: white;
  }
  label {
    display: block;
    margin-bottom: 12px;
    font-weight: 500;
    color: var(--text);
  }
  input, select {
    width: 100%;
    padding: 10px 12px;
    border: 1px solid #ccc;
    border-radius: 8px;
    font-size: 15px;
    box-sizing: border-box;
    background: var(--input);
    transition: border-color .2s;
  }
  input:focus, select:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 4px rgba(244,143,177,.3);
  }
  .phone-group {
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .country-select {
    width: 105px; /* üü¢ —É–≤–µ–ª–∏—á–µ–Ω–æ, —á—Ç–æ–±—ã –∫–æ–¥ —Ç–æ—á–Ω–æ –≤–ª–µ–∑ */
    min-width: 105px;
    padding: 10px;
    border-radius: 8px;
    border: 1px solid #ccc;
    background: var(--input);
  }
  .phone-input {
    flex: 1;
  }
  button {
    width: 100%;
    padding: 12px 0;
    background: var(--accent);
    color: #fff;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    cursor: pointer;
    font-weight: bold;
    margin-top: 20px;
    transition: background .2s;
  }
  button:hover { background: var(--accent-dark); }
  .privacy {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 13px;
    margin-top: 10px;
  }
  .msg {
    margin-top: 15px;
    text-align: center;
    font-weight: bold;
  }
  .msg.success { color: green; }
  .msg.error { color: darkred; }
  .hidden { display: none; }
</style>
</head>
<body>
<div class="form-box">
  <h2 id="title">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Beauty Expert</h2>
  <div class="lang-switch">
    <button type="button" data-lang="ru" class="active">RU</button>
    <button type="button" data-lang="ro">RO</button>
    <button type="button" data-lang="en">EN</button>
  </div>
  <form id="form">
    <label id="labelName">–§–ò–û
      <input type="text" name="fullName" required placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á">
    </label>
    <label id="labelPhone">–¢–µ–ª–µ—Ñ–æ–Ω</label>
    <div class="phone-group">
      <select id="countryCode" class="country-select">
        <option value="+373" selected>üá≤üá© +373</option>
        <option value="+7">üá∑üá∫ +7</option>
        <option value="+380">üá∫üá¶ +380</option>
        <option value="+40">üá∑üá¥ +40</option>
        <option value="+49">üá©üá™ +49</option>
        <option value="+1">üá∫üá∏ +1</option>
        <option value="+971">üá¶üá™ +971</option>
      </select>
      <input type="tel" class="phone-input" name="phone" required placeholder="123 456 789">
    </div>
    <label id="labelEmail">Email
      <input type="email" name="email" required placeholder="mail@example.com">
    </label>
    <label id="labelBirth">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è
      <input type="date" name="birthDate" required>
    </label>
    <label id="labelRole">–¢–∏–ø —É—á–∞—Å—Ç–Ω–∏–∫–∞
      <select id="role" name="role" required>
        <option value="">--–≤—ã–±–µ—Ä–∏—Ç–µ--</option>
        <option value="consultant" data-ru="–ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç" data-ro="Consultant" data-en="Consultant">–ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç</option>
        <option value="client" data-ru="–ö–ª–∏–µ–Ω—Ç" data-ro="Client" data-en="Client">–ö–ª–∏–µ–Ω—Ç</option>
      </select>
    </label>

    <div id="consultantsBlock" class="hidden">
      <label id="labelConsultant">–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–∞
        <select id="consultantSelect" name="consultant">
          <option value="">--–≤—ã–±–µ—Ä–∏—Ç–µ--</option>
        </select>
      </label>
    </div>

    <label class="privacy">
      <input type="checkbox" id="privacyCheck" required>
      <span id="privacyText">–°–æ–≥–ª–∞—Å–µ–Ω –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span>
    </label>

    <input type="hidden" name="chat_id" id="chat_id">

    <button type="submit" id="submitBtn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
    <div id="msg" class="msg"></div>
  </form>
</div>

<script>
/* üìå Chat ID */
document.getElementById('chat_id').value = new URLSearchParams(window.location.search).get('chat_id') || '';

/* üìå –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–æ–≤ */
const sheetURL = "https://opensheet.elk.sh/–í–ê–®_ID_–¢–ê–ë–õ–ò–¶–´/Consultant";
fetch(sheetURL)
  .then(r=>r.json())
  .then(rows=>{
    const select=document.getElementById('consultantSelect');
    rows.forEach(r=>{
      const opt=document.createElement('option');
      opt.value=r.ID || r.Name;
      opt.textContent=r.Name;
      select.appendChild(opt);
    });
  });

/* üìå –ü–æ–∫–∞–∑/—Å–∫—Ä—ã—Ç–∏–µ –±–ª–æ–∫–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–æ–≤ */
const roleSel=document.getElementById('role');
roleSel.addEventListener('change',()=>{
  const block=document.getElementById('consultantsBlock');
  if(roleSel.value==='client'){
    block.classList.remove('hidden');
    document.getElementById('consultantSelect').setAttribute('required','true');
  }else{
    block.classList.add('hidden');
    document.getElementById('consultantSelect').removeAttribute('required');
  }
});

/* üåç –ü–µ—Ä–µ–≤–æ–¥—ã */
const translations = {
  ru: {
    title: "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Beauty Expert",
    labelName: "–§–ò–û",
    labelPhone: "–¢–µ–ª–µ—Ñ–æ–Ω",
    labelEmail: "Email",
    labelBirth: "–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è",
    labelRole: "–¢–∏–ø —É—á–∞—Å—Ç–Ω–∏–∫–∞",
    labelConsultant: "–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–∞",
    privacyText: "–°–æ–≥–ª–∞—Å–µ–Ω –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö",
    submitBtn: "–û—Ç–ø—Ä–∞–≤–∏—Ç—å",
    placeholders: {
      fullName: "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á",
      phone: "123 456 789",
      email: "mail@example.com"
    },
    options: { consultant: "–ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç", client: "–ö–ª–∏–µ–Ω—Ç" }
  },
  ro: {
    title: "√énregistrare Beauty Expert",
    labelName: "Nume complet",
    labelPhone: "Telefon",
    labelEmail: "Email",
    labelBirth: "Data na»ôterii",
    labelRole: "Tip participant",
    labelConsultant: "Alege consultant",
    privacyText: "Sunt de acord cu prelucrarea datelor personale",
    submitBtn: "Trimite",
    placeholders: {
      fullName: "Ion Popescu",
      phone: "123 456 789",
      email: "mail@example.com"
    },
    options: { consultant: "Consultant", client: "Client" }
  },
  en: {
    title: "Beauty Expert Registration",
    labelName: "Full Name",
    labelPhone: "Phone",
    labelEmail: "Email",
    labelBirth: "Date of Birth",
    labelRole: "Role",
    labelConsultant: "Choose Consultant",
    privacyText: "I agree to personal data processing",
    submitBtn: "Submit",
    placeholders: {
      fullName: "John Smith",
      phone: "123 456 789",
      email: "mail@example.com"
    },
    options: { consultant: "Consultant", client: "Client" }
  }
};

document.querySelectorAll('.lang-switch button').forEach(btn=>{
  btn.addEventListener('click',()=>{
    const lang=btn.dataset.lang;
    document.querySelectorAll('.lang-switch button').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');

    const t=translations[lang];
    document.getElementById('title').textContent=t.title;
    document.getElementById('labelName').childNodes[0].textContent=t.labelName;
    document.getElementById('labelPhone').textContent=t.labelPhone;
    document.getElementById('labelEmail').childNodes[0].textContent=t.labelEmail;
    document.getElementById('labelBirth').childNodes[0].textContent=t.labelBirth;
    document.getElementById('labelRole').childNodes[0].textContent=t.labelRole;
    document.getElementById('labelConsultant').childNodes[0].textContent=t.labelConsultant;
    document.getElementById('privacyText').textContent=t.privacyText;
    document.getElementById('submitBtn').textContent=t.submitBtn;
    document.querySelector('input[name="fullName"]').placeholder=t.placeholders.fullName;
    document.querySelector('input[name="phone"]').placeholder=t.placeholders.phone;
    document.querySelector('input[name="email"]').placeholder=t.placeholders.email;

    // –ü–µ—Ä–µ–≤–æ–¥ –æ–ø—Ü–∏–π –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞
    const optConsultant=document.querySelector('#role option[value="consultant"]');
    const optClient=document.querySelector('#role option[value="client"]');
    optConsultant.textContent=t.options.consultant;
    optClient.textContent=t.options.client;
  });
});

/* üìå –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã */
const form=document.getElementById('form');
const msg=document.getElementById('msg');
form.addEventListener('submit',async e=>{
  e.preventDefault();
  msg.textContent='';
  msg.className='msg';
  
  if(!document.getElementById('privacyCheck').checked){
    msg.textContent='‚ö† –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö.';
    msg.classList.add('error');
    return;
  }

  const data={
    fullName:form.fullName.value.trim(),
    phone:document.getElementById('countryCode').value + form.phone.value.trim(),
    email:form.email.value.trim(),
    birthDate:form.birthDate.value,
    role:roleSel.value,
    consultant: document.getElementById('consultantSelect').value || null,
    chat_id: document.getElementById('chat_id').value
  };

  try{
    const webhookUrl='https://hook.eu2.make.com/9h9m39efm8lp2sen3fm6y6rm74rrc73n';
    const res=await fetch(webhookUrl,{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify(data)
    });
    if(res.ok){
      msg.textContent='‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã!';
      msg.classList.add('success');
      form.reset();
    }else{
      const txt=await res.text();
      msg.textContent=`‚ùå –û—à–∏–±–∫–∞ ${res.status}: ${txt}`;
      msg.classList.add('error');
    }
  }catch(err){
    msg.textContent='‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ.';
    msg.classList.add('error');
  }
});
</script>
</body>
</html>
